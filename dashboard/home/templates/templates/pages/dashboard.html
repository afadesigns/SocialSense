{% extends 'layouts/base.html' %}
{% load static %}

{% block content %}
<div class="content">
    <!-- Instagram Profile and Recent Media Sections -->

    <!-- New Section for Instagram Insights Charts -->
    {% if insights_data %}
    <div class="row">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h4 class="card-title">Instagram Followers Growth</h4>
                </div>
                <div class="card-body">
                    <div class="chart-area">
                        <canvas id="followersGrowthChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h4 class="card-title">Engagement Rate</h4>
                </div>
                <div class="card-body">
                    <div class="chart-area">
                        <canvas id="engagementRateChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h4 class="card-title">Post Reach</h4>
                </div>
                <div class="card-body">
                    <div class="chart-area">
                        <canvas id="reachChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        <!-- Other charts can be added here following the same pattern -->
    </div>
    {% endif %}
    {% include 'includes/footer.html' %}
</div>
{% endblock content %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
$(document).ready(function () {
    // Assuming insights_data is passed as a JSON string; parse it to use in JavaScript
    var insightsData = JSON.parse('{{ insights_data|safe }}');

    // Followers Growth Chart Initialization
    var followersData = {
        labels: insightsData.followers_growth_data.labels,
        datasets: [{
            label: 'Followers Growth',
            data: insightsData.followers_growth_data.data,
            fill: false,
            borderColor: 'rgb(75, 192, 192)',
            tension: 0.1
        }]
    };
    new Chart(document.getElementById('followersGrowthChart'), {
        type: 'line',
        data: followersData,
    });

    // Engagement Rate Chart Initialization
    var engagementData = {
        labels: insightsData.engagement_rate_data.labels,
        datasets: [{
            label: 'Engagement Rate',
            data: insightsData.engagement_rate_data.data,
            fill: false,
            borderColor: 'rgb(255, 159, 64)',
            tension: 0.1
        }]
    };
    new Chart(document.getElementById('engagementRateChart'), {
        type: 'line',
        data: engagementData,
    });

    // Post Reach Chart Initialization
    var reachData = {
        labels: insightsData.post_reach_data.labels,
        datasets: [{
            label: 'Post Reach',
            data: insightsData.post_reach_data.data,
            fill: false,
            borderColor: 'rgb(54, 162, 235)',
            tension: 0.1
        }]
    };
    new Chart(document.getElementById('reachChart'), {
        type: 'line',
        data: reachData,
    });

    // Initialize more charts as needed with similar patterns
});
</script>
{% endblock extra_js %}
